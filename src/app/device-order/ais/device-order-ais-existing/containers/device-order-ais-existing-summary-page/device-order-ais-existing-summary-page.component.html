<div class="mc-flex">
    <mc-header title="ลูกค้าปัจจุบัน">
      <div class="header-icon-left">
        <mc-header-icon src="assets/images/icon/icon-back.png" (iconClick)="onBack()"></mc-header-icon>
      </div>
      <div class="header-icon-right">
        <mc-header-icon src="assets/images/icon/icon-home.png" (iconClick)="onHome()"></mc-header-icon>
      </div>
    </mc-header>
    <div class="mc-flex-wrap">
      <mc-shopping-cart [shoppingCart]="shoppingCart"></mc-shopping-cart>
      <div class="mt-3 mb-3">
        <mc-wizard [wizards]="wizards" active="4"></mc-wizard>
        <div class="container-fluid">
          <div class="card mb-3">
            <div class="card-header bg-pink text-white">สรุปรายการสั่งชื้อสินค้า</div>
            <div class="card-body">
              <p class="text-green">{{ priceOption?.campaign?.campaignName }}</p>
              <div class="text-light-grey">
                <p>
                  <i class="fa fa-circle mr-3 text-green"></i>
                  {{ priceOption?.productDetail?.name }}
                  <span *ngIf="priceOption?.productStock?.color">
                    สี {{ priceOption?.productStock?.color }}
                  </span>
                  <span *ngIf="priceOption?.productStock?.productSubType === 'HANDSET BUNDLE'">
                    (แถมซิม)
                  </span>
                  <span class="pull-right text-green">
                    ฿ {{ priceOption?.trade?.promotionPrice | number }}
                  </span>
                </p>
                <p *ngIf="priceOption?.trade?.advancePay?.amount > 0">
                  <i class="fa fa-circle mr-3 text-green"></i>
                  {{ priceOption?.trade?.advancePay?.description }}
                  <span class="pull-right text-green">
                    ฿ {{ priceOption?.trade?.advancePay?.amount | number }}
                  </span>
                </p>
              </div>
            </div>
            <div class="card-footer bg-transparent text-right">
              รวมยอดชำระ(รวมVAT)
              <span class="text-green ml-2">
                ฿ {{ summary([
                +priceOption?.trade?.promotionPrice,
                +priceOption?.trade?.advancePay?.amount
                ]) | number }}
              </span>
            </div>
          </div>
  
          <div class="card mb-3">
            <div class="card-header bg-lime text-white">แพ็กเกจใช้บริการ</div>
            <div class="card-body">
              <p>
                <i class="fa fa-circle mr-3 text-green"></i>
                {{ transaction?.data?.mainPackage?.title }}
                <span class="pull-right" (click)="onOpenDetail(transaction?.data?.mainPackage?.detailTH)">
                  <img src="assets/images/icon/icon-page.png" class="icon" />
                </span>
              </p>
            </div>
            <div class="card-footer bg-transparent text-right">
            </div>
          </div>
  
          <div class="card mb-3">
            <div class="card-header bg-purple text-white">สินค้าและบริการอื่น</div>
            <div class="card-body">
              <p>
                <i class="fa fa-circle mr-3 text-green"></i>
                <ng-container *ngIf="!transaction?.data?.mobileCarePackage?.title">
                  <span>ไม่ซื้อบริการโมบายแคร์</span>
                </ng-container>
                <ng-container *ngIf="transaction?.data?.mobileCarePackage?.title">
                  <span>
                    {{ transaction?.data?.mobileCarePackage?.title }}
                  </span>
                  <span class="pull-right" (click)="onOpenDetail(transaction?.data?.mobileCarePackage?.detailTH)">
                    <img src="assets/images/icon/icon-page.png" class="icon" />
                  </span>
                </ng-container>
              </p>
            </div>
            <div class="card-footer bg-transparent text-right">
            </div>
          </div>
  
          <div class="card mb-3">
            <div class="card-header bg-pink text-white">
              รายละเอียดการชำระ
            </div>
            <div class="card-body">
              <p>
                ข้อมูลการชำระสินค้า
              </p>
  
              <!-- ชำระเต็มจำนวน -->
              <ng-container
                *ngIf="!priceOption?.trade?.advancePay || priceOption?.trade?.advancePay?.installmentFlag === 'N'">
                <p>
                  <i class="fa fa-circle mr-3 text-green"></i>
                  {{ priceOption?.productDetail?.name }}
                  <span *ngIf="priceOption?.productStock?.color">
                    สี {{ priceOption?.productStock?.color }}
                  </span>
                  <span *ngIf="priceOption?.productStock?.productSubType === 'HANDSET BUNDLE'">
                    (แถมซิม)
                  </span>
                  <span *ngIf="transaction?.data?.payment?.paymentForm === 'FULL'">: ชำระเต็มจำนวน</span>
                  <span *ngIf="transaction?.data?.payment?.paymentForm === 'INSTALLMENT'">: ผ่อนชำระบัตรเครดิต</span>
                  <span class="pull-right text-green">
                    ฿ {{ priceOption?.trade?.promotionPrice | number }}
                  </span>
                </p>
                <small class="text-muted">
                  (ชำระโดย {{ summaryPageService.detailPayment(transaction?.data?.payment, priceOption?.trade) }})
                </small>
                <!-- ค่าแพ็กเกจบริการล่วงหน้า -->
                <p class="mt-3" *ngIf="(+priceOption?.trade?.advancePay?.amount) > 0">
                  <i class="fa fa-circle mr-3 text-green"></i>
                  ค่าแพ็กเกจบริการล่วงหน้า : ชำระเต็มจำนวน
                  <span class="pull-right text-green">
                    ฿ {{ priceOption?.trade?.advancePay?.amount | number }}
                  </span>
                </p>
                <small class="text-muted" *ngIf="(+priceOption?.trade?.advancePay?.amount) > 0">
                  (ชำระโดย {{ summaryPageService.descriptionPayment(transaction?.data?.advancePayment) }})
                </small>
              </ng-container>
  
              <!-- ค่าเครื่องและค่าแพ็กเกจล่วงหน้า -->
              <ng-container *ngIf="priceOption?.trade?.advancePay?.installmentFlag === 'Y'">
                <p>
                  <i class="fa fa-circle mr-3 text-green"></i>
                  ค่าเครื่องและค่าแพ็กเกจล่วงหน้า :
                  <span *ngIf="transaction?.data?.payment?.paymentForm === 'FULL'">ชำระเต็มจำนวน</span>
                  <span *ngIf="transaction?.data?.payment?.paymentForm === 'INSTALLMENT'">ผ่อนชำระบัตรเครดิต</span>
                  <span class="pull-right text-green">฿ {{ summary([
                    +priceOption?.trade?.promotionPrice,
                    +priceOption?.trade?.advancePay?.amount
                    ]) | number }}</span>
                </p>
                <small class="text-muted">
                  (ชำระโดย {{ summaryPageService.detailPayment(transaction?.data?.payment, priceOption?.trade) }})
                </small>
              </ng-container>
  
            </div>
            <div class="card-footer bg-transparent ">
              <p>
                ข้อมูลใบเสร็จรับเงิน
              </p>
              <div class="row">
                <p class="col-12 col-sm-4">
                  <i class="fa fa-circle mr-3 text-green"></i>
                  ผู้ชื้อ
                </p>
                <p class="col-12 col-sm-8 text-green">
                  {{ transaction?.data?.customer?.titleName }}
                  {{ transaction?.data?.customer?.firstName }}
                  {{ transaction?.data?.customer?.lastName }}
                </p>
                <p class="col-12 col-sm-4">
                  <i class="fa fa-circle mr-3 text-green"></i>
                  ที่อยู่ในใบเสร็จรับเงิน
                </p>
                <p class="col-12 col-sm-8 text-green">
                  {{ customerAddress }}
                </p>
              </div>
            </div>
            <div class="card-footer bg-transparent">
              <p>
                ข้อตกลงรับสิทธิ์ต่อเนื่อง
              </p>
              <p>
                <i class="fa fa-circle mr-3 text-green"></i>
                รับสิทธิ์ต่อเนื่องนาน {{ priceOption?.campaign?.maximumContract }} เดือน
              </p>
  
            </div>
            <div class="card-footer bg-transparent text-right">
            </div>
          </div>
  
        </div>
      </div>
    </div>
    <mc-footer>
      <button class="btn btn-secondary" (click)="onBack()">BACK</button>
      <button class="btn btn-success" (click)="onNext()">NEXT</button>
    </mc-footer>
  </div>
  
  <ng-template #detailTemplate>
    <div class="modal-body" [innerHTML]="detail"></div>
    <div class="modal-footer">
      <div class="w-100 text-center">
        <button class="btn btn-success px-5" (click)="modalRef.hide()">ปิด</button>
      </div>
    </div>
  </ng-template>