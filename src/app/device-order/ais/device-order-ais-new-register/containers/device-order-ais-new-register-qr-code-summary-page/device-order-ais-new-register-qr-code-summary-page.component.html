<div class="mc-flex">
  <mc-header title="เครื่องพร้อมเปิดเบอร์ใหม่">
    <div class="header-icon-left">
      <mc-header-icon src="assets/images/icon/icon-back.png" (iconClick)="onBack()"></mc-header-icon>
    </div>
    <div class="header-icon-right">
      <mc-header-icon src="assets/images/icon/icon-home.png" (iconClick)="onHome()"></mc-header-icon>
    </div>
  </mc-header>
  <div class="mc-flex-wrap bg-white">
    <div class="my-3">
      <div class="container">
        <div class="pt-2 pb-2  row">
          <div class="col-6">
            <img src="assets/images/icon/icon-person.png" class="icon-person" />
            {{ transaction?.data?.customer?.titleName }}
            {{ transaction?.data?.customer?.firstName }}
            {{ transaction?.data?.customer?.lastName }}
          </div>
          <div class="col-6 text-right">
            <img src="assets/images/icon/sales_portal_green_phone.png" class="icon-mobile" />
            {{ transaction?.data?.simCard?.mobileNo | mobileNo }}
          </div>
        </div>

        <div class="card mb-3">
          <div class="card-header bg-pink text-white">สรุปรายการสั่งชื้อสินค้า</div>
          <div class="card-body">
            <p class="text-green">{{ priceOption?.campaign?.campaignName }}</p>
            <div class="text-light-grey">
              <p>
                <i class="fa fa-circle mr-3 text-green"></i>
                {{ priceOption?.productDetail?.name }}
                <span *ngIf="priceOption?.productStock?.color">
                  {{ priceOption?.productStock?.color?'สี': '' }} {{ priceOption?.productStock?.color }}
                </span>
                <span *ngIf="priceOption?.productStock?.productSubType === 'HANDSET BUNDLE'">
                  (แถมซิม)
                </span>
                <span class="pull-right text-green">
                  ฿ {{ priceOption?.trade?.promotionPrice | number }}
                </span>
              </p>
              <p *ngIf="priceOption?.trade?.advancePay?.amount > 0">
                <i class="fa fa-circle mr-3 text-green"></i>
                {{ priceOption?.trade?.advancePay?.description }}
                <span class="pull-right text-green">
                  ฿ {{ priceOption?.trade?.advancePay?.amount | number }}
                </span>
              </p>
            </div>
          </div>
          <div class="card-footer bg-transparent text-right">
            รวมยอดชำระ(รวมVAT)
            <span class="text-green ml-2">
              ฿ {{ summary([+priceOption?.trade?.promotionPrice, +priceOption?.trade?.advancePay?.amount]) | number }}
            </span>
          </div>
        </div>

        <div class="card mb-3 mt-4">
          <div class="card-header bg-pink text-white"> รายละเอียดการชำระ </div>
          <div class="card-body text-light-grey">

            <!-- ชำระค่าเครื่อง AWN ------------------------------------------------------------------------------------->
            <div *ngIf="priceOption?.productStock?.company !== 'WDS'">
              <!-- ชำระค่าเครื่อง (ผ่อนแยก)-->
              <ng-container
                *ngIf="!priceOption?.trade?.advancePay || priceOption?.trade?.advancePay?.installmentFlag === 'N'">
                <div class="mb-3">
                  <input class="form-check-input" type="radio" id="installmentNoAdvancePay" disabled=""
                    [checked]="transaction?.data?.payment?.paymentQrCodeType">
                  <label class="form-check-label" for="installmentNoAdvancePay">
                    {{ priceOption?.productDetail?.name }}
                    <span *ngIf="priceOption?.productStock?.color">
                      สี {{ priceOption?.productStock?.color }}
                    </span>
                    <span *ngIf="priceOption?.productStock?.productSubType === 'HANDSET BUNDLE'">
                      (แถมซิม)
                    </span>
                    <span *ngIf="transaction?.data?.payment?.paymentForm === 'FULL'">: ชำระเต็มจำนวน</span>
                    <span *ngIf="transaction?.data?.payment?.paymentForm === 'INSTALLMENT'">: ผ่อนชำระบัตรเคดิต</span>
                  </label>
                  <span class="pull-right text-green">
                    ฿ {{ priceOption?.trade?.promotionPrice | number }}
                  </span>
                  <div class="mt-1">
                    <small class="text-muted">
                      ( ชำระโดย
                      <span *ngIf="transaction?.data?.advancePayment?.paymentQrCodeType === 'THAI_QR'"> Thai QR Promptpay </span>
                      <span *ngIf="transaction?.data?.advancePayment?.paymentQrCodeType === 'LINE_QR'"> Rabbit Line Pay </span>
                      )
                    </small>
                  </div>
                </div>

                <!-- ค่าแพ็กเกจบริการล่วงหน้า -->
                <div *ngIf="priceOption?.trade?.advancePay?.installmentFlag === 'N' && (+priceOption?.trade?.advancePay?.amount) > 0">
                    <input class="form-check-input" type="radio" id="advancePay" disabled=""
                      [checked]="transaction?.data?.advancePayment?.paymentQrCodeType">
                    <label class="form-check-label" for="advancePay">
                      ค่าแพ็กเกจบริการล่วงหน้า : ชำระเต็มจำนวน
                    </label>
                    <span class="pull-right text-green">
                      ฿ {{ priceOption?.trade?.advancePay?.amount | number }}
                    </span>
                  <small class="text-muted">
                    ( ชำระโดย
                    <span *ngIf="transaction?.data?.advancePayment?.paymentQrCodeType === 'THAI_QR'"> Thai QR Promptpay </span>
                    <span *ngIf="transaction?.data?.advancePayment?.paymentQrCodeType === 'LINE_QR'"> Rabbit Line Pay </span>
                    )
                  </small>
                </div>
              </ng-container>

              <!-- ค่าเครื่องและค่าแพ็กเกจล่วงหน้า (ผ่อนรวม) -->
              <ng-container *ngIf="priceOption?.trade?.advancePay?.installmentFlag === 'Y'">
                <div>
                  <input class="form-check-input" type="radio" id="installmentAdvancePay" disabled="" checked="true">
                  <label class="form-check-label" for="installmentAdvancePay">
                    ค่าเครื่องและค่าแพ็กเกจล่วงหน้า :
                    <span *ngIf="transaction?.data?.payment?.paymentForm === 'FULL'">ชำระเต็มจำนวน</span>
                    <span *ngIf="transaction?.data?.payment?.paymentForm === 'INSTALLMENT'">ผ่อนชำระบัตรเคดิต</span>
                  </label>
                  <span class="pull-right text-green">฿ {{ summary([ +priceOption?.trade?.promotionPrice, 
                    +priceOption?.trade?.advancePay?.amount
                    ]) | number:'1.0-0' }}</span>
                </div>
                <div class="mt-1">
                  <small class="text-muted" *ngIf="transaction?.data?.payment?.paymentType !== 'QR_CODE'">
                    (ชำระโดย เงินสด)
                  </small>
                  <small class="text-muted" *ngIf="transaction?.data?.payment?.paymentType === 'QR_CODE'">
                    ( ชำระโดย
                    <span *ngIf="transaction?.data?.payment?.paymentQrCodeType === 'THAI_QR'"> Thai QR Promptpay </span>
                    <span *ngIf="transaction?.data?.payment?.paymentQrCodeType === 'LINE_QR'"> Rabbit Line Pay </span>
                    )
                  </small>
                </div>
              </ng-container>
            </div>


            <!-- ชำระค่าเครื่อง WDS ------------------------------------------------------------------------------------------------>
            <div *ngIf="priceOption?.productStock?.company === 'WDS'">

              <!-- ค่าเครื่องและค่าแพ็กเกจล่วงหน้า (ผ่อนรวม) สำหรับ WDS -->
              <ng-container *ngIf="priceOption?.trade?.advancePay?.installmentFlag === 'Y'">
                <div>
                  <input class="form-check-input" type="radio" id="installmentAdvancePay" disabled="" checked="true">
                  <label class="form-check-label" for="installmentAdvancePay">
                    {{ priceOption?.productDetail?.name }} :
                    <span *ngIf="transaction?.data?.payment?.paymentForm === 'FULL'">ชำระเต็มจำนวน</span>
                    <span *ngIf="transaction?.data?.payment?.paymentForm === 'INSTALLMENT'">ผ่อนชำระบัตรเคดิต</span>
                  </label>
                  <span class="pull-right text-green">
                      ฿ {{ priceOption?.trade?.promotionPrice | number }}</span>
                </div>
                <div class="mt-1">
                  <small class="text-muted" *ngIf="transaction?.data?.payment?.paymentType !== 'QR_CODE'">
                    (ชำระโดย เงินสด)
                  </small>
                  <small class="text-muted" *ngIf="transaction?.data?.payment?.paymentType === 'QR_CODE'">
                    ( ชำระโดย
                    <span *ngIf="transaction?.data?.payment?.paymentQrCodeType === 'THAI_QR'"> Thai QR Promptpay </span>
                    <span *ngIf="transaction?.data?.payment?.paymentQrCodeType === 'LINE_QR'"> Rabbit Line Pay </span>
                    )
                  </small>
                  <span class="text-pink">( รอชำระ )</span>
                </div>
                <div>
                    <input class="form-check-input" type="radio" id="installmentAdvancePay" disabled="" >
                    <label class="form-check-label" for="installmentAdvancePay">
                      ค่าแพ็กเกจชำระล่วงหน้า :
                      <span *ngIf="transaction?.data?.payment?.paymentForm === 'FULL'">ชำระเต็มจำนวน</span>
                      <span *ngIf="transaction?.data?.payment?.paymentForm === 'INSTALLMENT'">ผ่อนชำระบัตรเคดิต</span>
                    </label>
                    <span class="pull-right text-green">
                        ฿ {{ priceOption?.trade?.advancePay?.amount | number }}</span>
                  </div>
                  <div class="mt-1">
                    <small class="text-muted" *ngIf="transaction?.data?.payment?.paymentType !== 'QR_CODE'">
                      (ชำระโดย เงินสด)
                    </small>
                    <small class="text-muted" *ngIf="transaction?.data?.payment?.paymentType === 'QR_CODE'">
                      ( ชำระโดย
                      <span *ngIf="transaction?.data?.payment?.paymentQrCodeType === 'THAI_QR'"> Thai QR Promptpay </span>
                      <span *ngIf="transaction?.data?.payment?.paymentQrCodeType === 'LINE_QR'"> Rabbit Line Pay </span>
                      )
                    </small>
                    <span class="text-pink">( รอชำระ )</span>
                  </div> 
              </ng-container>
            </div>




          </div>
        </div>
      </div>

      <div class="container">
        <div class="row">
          <div class="col-8">
            <img src="assets/images/icon/phone_qrcode.png" class="mr-2" />
            ชำระด้วย QR Code
            <div class="text-pink">กรุณาเปิด Application เพื่อสแกน QR Code</div>
          </div>
          <div class="col-4 text-right">
            <div
              *ngIf="transaction?.data?.payment?.paymentQrCodeType === 'THAI_QR' || transaction?.data?.advancePayment?.paymentQrCodeType === 'THAI_QR'">
              <img class="img-fluid w-100" src="assets/images/icon/Thai_Qr_Payment.png" />
            </div>
            <div
              *ngIf="transaction?.data?.payment?.paymentQrCodeType === 'LINE_QR' || transaction?.data?.advancePayment?.paymentQrCodeType === 'LINE_QR'">
              <img class="img-fluid w-100" src="assets/images/icon/Rabbit_Line_Pay.png" />
            </div>
          </div>
          <div class="col-12 mt-3">
            <form class="form-inline pull-right">
              <div class="form-group">
                <label for="summaryInput" class="text-green">ยอดชำระ</label>
                <input style="text-align: center" type="text" id="summaryInput" disabled
                  class="form-control ml-3 text-green" value="฿ {{ getTotal() | number }}">
              </div>
            </form>
          </div>
        </div>
      </div>

    </div>
  </div>
  <mc-footer>
    <button class="btn btn-secondary" (click)="onBack()">BACK</button>
    <button class="btn btn-success" (click)="onNext()">PAY NOW</button>
  </mc-footer>
</div>